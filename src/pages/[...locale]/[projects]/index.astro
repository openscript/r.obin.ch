---
import type { InferGetStaticPropsType } from "astro";
import DefaultLayout from "../../../layouts/DefaultLayout.astro";
import { getLocaleFromUrl, useTranslations } from "../../../utils/i18n";
import { indexPaths } from "../../_paths";
import Page from "../../../layouts/pages/Page.astro";
import Meta from "../../../layouts/groups/Meta.astro";
import { defaultProjectsCollection } from "../../../collections/projects";
import CardList from "../../../components/CardList.astro";
import ProjectCard from "../../../components/ProjectCard.astro";

export const getStaticPaths = indexPaths("projects");

type Props = InferGetStaticPropsType<typeof getStaticPaths>;
const { translations } = Astro.props as Props;
const projects = defaultProjectsCollection;
const locale = getLocaleFromUrl(Astro.url);
const t = useTranslations(locale);
---

<DefaultLayout translations={translations}>
  <Meta slot="meta" title={t("projectsTitle")} />
  <Page>
    <h1>{t("projectsTitle")}</h1>
    <CardList>
      {
        projects.map(async (project) => {
          return <ProjectCard project={project} locale={locale} />;
        }).filter(Boolean)
      }
    </CardList>
  </Page>
</DefaultLayout>
